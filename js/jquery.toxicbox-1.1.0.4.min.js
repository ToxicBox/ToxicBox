//jquery.toxicbox ver.1.1.0.4.min, MIT L, ToxicBox - C 2015-2016 Berestov Andrey, http://my-gallery.name
var toxicbox_options={};$(function(){window.ToxicBox=function(){function C(){(navigator.userAgent.indexOf("Presto")+1||navigator.userAgent.indexOf("iPhone")+1||navigator.userAgent.indexOf("iPad")+1||navigator.userAgent.indexOf("Android")+1)&&(m=window.innerWidth)}function D(){return x=Math.round(window.outerWidth/window.innerWidth*100)/100}function E(){$("body").prepend('<img src="'+g+'loader.gif" alt="" id="toxicbox_loading" style="top:0;margin-top:'+(n/2-20+$(window).scrollTop())+"px;margin-left:"+(m/2-20+$(window).scrollLeft())+'px;"  />')}function F(){s||$("#toxicbox .toxicbox_left_arrow a").remove(),t||$("#toxicbox .toxicbox_right_arrow a").remove()}function G(){$(new Image).attr("src",$(s).attr("href")),$(new Image).attr("src",$(t).attr("href"))}function H(a){function e(a){$(a).css({"max-height":n-f.height()-2*h+"px",width:"auto"}),r=$(a).width(),$(a).css("width",r+"px"),q=$(a).height()}var d,b=$("#toxicbox"),c=$("#toxicbox_loading");b.prepend('<img src="'+$(u).attr("href")+'" alt="" class="toxicbox_the_current_object toxicbox_hidden" style="max-width:'+(m-2*h)+"px;max-height:"+n+'px;" /><div id="toxicbox_text_frame" class="toxicbox_hidden" style="min-height:'+(41+h)+"px;margin-top:"+h+'px;"></div>');var f=$("#toxicbox_text_frame");if(21==w&&(z-=1,s=p[z-2],t=p[z],G()),22==w&&(z+=1,s=p[z-2],t=p[z],G()),2==w)for(d=0;d<o;d++)if(u==p[d]){z=d+1,s=p[d-1],t=p[d+1],G();break}$(".toxicbox_the_current_object").on("load",function(){q=$(this).height(),r=$(this).width(),e(this),a?(2!=w&&21!=w&&22!=w||(f.css("width",r-2*h-40+"px").html('<div id="toxicbox_arrow_frame" style="width:'+r+'px;"><div class="toxicbox_left toxicbox_left_arrow" style="margin-left:-20px;" ><a href="#back"><img src="'+g+'left.png" alt="" /></a></div><div class="toxicbox_left toxicbox_right_arrow"><a href="#next"><img src="'+g+'right.png" alt="" /></a></div></div><p class="toxicbox_center toxicbox_pictures_count">'+y.im+" "+z+" "+y.o+" "+o+'</p><p class="toxicbox_center toxicbox_name_of_picture" style="margin-bottom:'+h+'px;">'+a+"</p>"),F()),1==w&&f.html('<p class="toxicbox_center toxicbox_name_of_picture" style="width:'+($(this).width()-40)+"px;margin-bottom:"+h+'px;">'+a+"</p>")):(2!=w&&21!=w&&22!=w||(f.html('<p class="toxicbox_center toxicbox_pictures_count" >'+y.im+" "+z+" "+y.o+" "+o+"</p>").prepend('<div id="toxicbox_arrow_frame" style="width:'+r+'px;"><div class="toxicbox_left toxicbox_left_arrow" style="margin-left:-20px;" ><a href="#back"><img src="'+g+'left.png" alt="" /></a></div><div class="toxicbox_left toxicbox_right_arrow"><a href="#next"><img src="'+g+'right.png" alt="" /></a></div></div>'),F()),1==w&&f.css({height:20+h+"px","min-height":0})),e(this),$("#toxicbox .toxicbox_right_arrow, #toxicbox .toxicbox_left_arrow").css("width",""+((r+20)/2-10)+"px"),q=f.height()+q,b.prepend('<a href="#index" class="toxicbox_parent_of_close_button"><img id="toxicbox_close_image" class="toxicbox_hidden toxic_images_close" src="'+g+'close.png" alt="" /></a>'),$("#toxicbox_close_image").css({"margin-left":r-20+"px","margin-top":q-20+"px"}),b.velocity({left:m/2-(r/2+h)+$(window).scrollLeft(),top:n/2+$(window).scrollTop()-(q/2+h),width:r,height:q},600/i,function(){c.velocity("fadeOut",150/i),f.css("width",r-40),$("#toxicbox .toxicbox_the_current_object, #toxicbox #toxicbox_text_frame, #toxicbox #toxicbox_close_image").velocity("fadeIn",150/i)})})}function I(){var a=$(u).attr("title");"on"!=f||a||(a=$(u).find("img").attr("alt")),$(u).attr("data-toxic-name")&&(p=$('a[data-toxic-name="'+$(u).attr("data-toxic-name")+'"]'),o=p.length),$("body").append('<div id="toxicbox_darkness_substrate" class="toxic_images_close"></div><div id="toxicbox" style="height:'+B+"px;width:"+A+"px;left:"+(m/2-h-A/2+$(window).scrollLeft())+"px;top:"+(n/2-h-B/2+$(window).scrollTop())+"px;padding:"+h+'px;"></div>'),E(),$(new Image).attr("src",$(u).attr("href")).on("load",H(a))}function J(a,b){u&&(v=$("#"+$(u).attr("data-toxic-databox"))),a&&(v=$("#"+a)),$("body").append('<div id="toxicbox_darkness_substrate" class="toxicbox_databox_prefix"></div><div id="toxicbox" style="height:'+B+"px;width:"+A+"px;left:"+(m/2-h-A/2+$(window).scrollLeft())+"px;top:"+(n/2-h-B/2+$(window).scrollTop())+"px;padding:"+h+'px;"></div>');var c=$("#toxicbox"),f=parseInt(v.css("paddingBottom")),j=parseInt(v.css("paddingTop")),k=parseInt(v.css("paddingLeft")),l=parseInt(v.css("paddingRight")),o=$(u).attr("title");b&&(o=b),E();var p=$("#toxicbox_loading");r=v.width()+parseInt(v.css("borderLeftWidth"))+parseInt(v.css("borderRightWidth"))+l+k,r==m&&("on"==e?(r=d,$(v).css("width",r+"px")):r=m-2*h),r>m&&(r=m-parseInt(v.css("borderLeftWidth"))-parseInt(v.css("borderRightWidth"))-l-k-2*h,v.css({width:r+"px",height:"auto"}).find("iframe").attr("width",r)),q=$(v).height()+20+parseInt(v.css("borderTopWidth"))+parseInt(v.css("borderBottomWidth"))+j+f+h,o&&(c.prepend('<h2 id="toxicbox_header" style="width:'+r+"px;margin-bottom:"+h+'px;" class="toxicbox_hidden toxicbox_center">'+o+"</h2>"),q+=parseInt($("#toxicbox_header").css("height"))+parseInt($("#toxicbox_header").css("marginTop"))+parseInt($("#toxicbox_header").css("marginBottom"))+parseInt($("#toxicbox_header").css("paddingTop"))+parseInt($("#toxicbox_header").css("paddingBottom"))),c.velocity({width:r,height:q,marginLeft:-(r/2-A/2),marginTop:-n/2+(n-q)/2+B/2},600/i,function(){p.velocity("fadeOut",150/i,function(){$(this).remove()}),c.append(v,'<a href="#index" class="toxicbox_parent_of_close_button"><img id="toxicbox_close_image" class="toxicbox_hidden toxicbox_databox_prefix" src="'+g+'close.png" alt="" /></a>').css({"min-height":q+"px",height:"auto"}),o?v.css({marginLeft:k+"px",marginTop:j+parseInt($("#toxicbox_header").css("marginBottom"))+parseInt($("#toxicbox_header").css("paddingBottom"))+"px"}).velocity("fadeIn",150/i):v.css({marginLeft:k+"px",marginTop:j+"px"}).velocity("fadeIn",150/i),$("#toxicbox_close_image.toxicbox_databox_prefix").css({marginLeft:r-20+"px",marginTop:f+h+"px"}).velocity("fadeIn",150/i),$("#toxicbox_header").velocity("fadeIn",200/i),parseInt(c.css("top"))+(parseInt(c.css("marginTop"))-$(window).scrollTop())<0&&c.css({marginTop:"0",top:$(window).scrollTop()})})}function K(a){u&&(v=$(u).attr("data-toxic-alert")),a&&(v=a),$("body").append('<div id="toxicbox_darkness_substrate" class="toxic_images_close"></div><div id="toxicbox" class="toxicbox_alert_frame" style="height:'+B+"px;width:"+A+"px;left:"+(m/2-h-A/2+$(window).scrollLeft())+"px;top:"+(n/2-h-B/2+$(window).scrollTop())+"px;padding:"+h+'px;"></div>');var b=$("#toxicbox");b.html('<p class="toxicbox_alert_frame toxicbox_hidden" style="width:'+j+'px;">'+v+"</p>").prepend('<a href="#index" class="toxicbox_parent_of_close_button"><img id="toxicbox_close_image" class="toxicbox_hidden toxic_images_close" src="'+g+'close.png" alt="" /></a>'),E();var c=$("#toxicbox_loading"),d=$("#toxicbox p");r=d.width(),q=d.height()+20+h,r>=m&&(r=m-2*h,$("#toxicbox .toxicbox_alert_frame").css("max-width",r+"px"),q=d.height()+20+h),b.velocity({width:r,height:q,marginLeft:-(r/2-A/2),marginTop:-n/2+(n-q)/2+B/2},600/i,function(){c.velocity("fadeOut",150/i,function(){$(this).remove()}),d.velocity("fadeIn",150/i),$("#toxicbox_close_image.toxic_images_close").css({"margin-left":r-20+"px","margin-top":q-21+"px"}).velocity("fadeIn",150/i)})}function L(a,b){u=a,b=$(u).attr("title"),"on"!=f||b||(b=$(u).find("img").attr("alt")),E(),$(new Image).attr("src",$(u).attr("href")).on("load",function(){$("#toxicbox .toxicbox_the_current_object,#toxicbox #toxicbox_text_frame, #toxicbox #toxicbox_close_image, #toxicbox #toxicbox_arrow_frame").remove(),H(b)})}function M(){A||(A=k-2*h,B=A),$("#toxicbox").find(".toxicbox_databox_prefix").length&&($("body").append(v),v.css({display:"none",margin:0})),$("#toxicbox_loading").remove(),$("#toxicbox_darkness_substrate, #toxicbox").remove(),u=void 0,o=$('a[data-toxic="group"]:not([data-toxic-name])').length,p=$('a[data-toxic="group"]:not([data-toxic-name])')}function N(){return A=$("#toxicbox").width(),B=$("#toxicbox").height(),$("#toxicbox_darkness_substrate, #toxicbox, #toxicbox_loading").velocity("fadeOut",150/i,function(){M()}),!1}function O(){$("#toxicbox").is(":visible")&&(A=$("#toxicbox").width(),B=$("#toxicbox").height()),$("#toxicbox_darkness_substrate, #toxicbox, #toxicbox_loading").css("display","none"),M()}var s,t,u,v,w,x,y,z,a="en",b={im:"Фото",o:"из"},c={im:"Image",o:"of"},d=960,e="on",f="off",g="../images/toxic/",h=5,i=1,j=300,k=150,l={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return l.Android()||l.BlackBerry()||l.iOS()||l.Opera()||l.Windows()}},m=$(window).width(),n=$(window).height(),o=$('a[data-toxic="group"]:not([data-toxic-name])').length,p=$('a[data-toxic="group"]:not([data-toxic-name])'),q=0,r=0;Object.keys(toxicbox_options).length&&(toxicbox_options.language&&(a=toxicbox_options.language),toxicbox_options.padding&&(h=toxicbox_options.padding),toxicbox_options.images_url&&(g=toxicbox_options.images_url),toxicbox_options.alert_width&&(j=toxicbox_options.alert_width),toxicbox_options.basic_width&&(d=toxicbox_options.basic_width),toxicbox_options.auto_width&&(e=toxicbox_options.auto_width),toxicbox_options.speed&&(i=toxicbox_options.speed),toxicbox_options.auto_alt_to_title&&(f=toxicbox_options.auto_alt_to_title),toxicbox_options.start_box_size&&(k=toxicbox_options.start_box_size));var A=k-2*h,B=A;return $("a[data-toxic='single'], a[data-toxic='group']").addClass("toxicbox_zoom_style"),$(new Image).attr("src",g+"loader.gif"),y="ru"==a?b:c,C(),document.body.addEventListener("touchend",function(a){x=D(),m=screen.width/x,n=window.innerHeight,C()},!1),$(window).resize(function(){if(!l.any()){var a=$("#toxicbox");x=D(),m=$(window).width(),n=$(window).height(),a&&(a.css({"margin-left":"0px","margin-top":"0px",left:m/2-(r/2+h)+$(window).scrollLeft()+"px",top:n/2+$(window).scrollTop()-(q/2+h)+"px"}),parseInt(a.css("top"))<0&&a.css("top","0"))}}),$(document).on("click",".toxicbox_left_arrow a",function(){return w=21,$("#toxicbox_loading").remove(),L(s),!1}).on("click",".toxicbox_right_arrow a",function(){return w=22,$("#toxicbox_loading").remove(),L(t),!1}).on("click",'a[data-toxic="group"]',function(){return w=2,u=this,I(),!1}).on("click",'a[data-toxic="single"]',function(){return w=1,u=this,I(),!1}).on("click","[data-toxic-databox]",function(){return w=3,u=this,J(),!1}).on("click","[data-toxic-alert]",function(){return w=3,u=this,K(),!1}).on("click","#toxicbox_darkness_substrate, #toxicbox_close_image",function(){return N(),!1}).keyup(function(a){27==a.keyCode&&N()}),{GetDatabox:function(a,b,c){b||(b=0),setTimeout(function(){O(),J(a,c)},b)},GetAlert:function(a,b){b||(b=0),setTimeout(function(){O(),K(a)},b)}}}()});
