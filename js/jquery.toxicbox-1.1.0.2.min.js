//jquery.toxicbox ver.1.1.0.2.min, MIT L, ToxicBox - C 2015-2016 Berestov Andrey, http://my-gallery.name
var toxicbox_options={};$(function(){window.ToxicBox=function(){function t(){(navigator.userAgent.indexOf("Presto")+1||navigator.userAgent.indexOf("iPhone")+1||navigator.userAgent.indexOf("iPad")+1||navigator.userAgent.indexOf("Android")+1)&&(z=window.innerWidth)}function o(){return m=Math.round(window.outerWidth/window.innerWidth*100)/100}function i(){$("body").prepend('<img src="'+L+'loader.gif" alt="" id="toxic_loading" style="top:0;margin-top:'+(M/2-20+$(window).scrollTop())+"px;margin-left:"+(z/2-20+$(window).scrollLeft())+'px;"  />')}function c(){l||$("#toxic_showbox .toxic_larrow a").remove(),_||$("#toxic_showbox .toxic_rarrow a").remove()}function e(){$(new Image).attr("src",$(l).attr("href")),$(new Image).attr("src",$(_).attr("href"))}function n(t){function o(t){$(t).css({"max-height":M-s.height()-2*A+"px",width:"auto"}),G=$(t).width(),$(t).css("width",G+"px"),E=$(t).height()}var i,n=$("#toxic_showbox"),a=$("#toxic_loading");n.prepend('<img src="'+$(g).attr("href")+'" alt="" class="toxic_current toxic_hidden" style="max-width:'+(z-2*A)+"px;max-height:"+M+'px;" /><div id="toxic_textarea" class="toxic_hidden" style="min-height:'+(41+A)+"px;margin-top:"+A+'px;"></div>');var s=$("#toxic_textarea");if(21==f&&(v-=1,l=C[v-2],_=C[v],e()),22==f&&(v+=1,l=C[v-2],_=C[v],e()),2==f)for(i=0;R>i;i++)if(g==C[i]){v=i+1,l=C[i-1],_=C[i+1],e();break}$(".toxic_current").on("load",function(){E=$(this).height(),G=$(this).width(),o(this),t?((2==f||21==f||22==f)&&(s.css("width",G-2*A-40+"px").html('<div id="toxic_arrow_carrier" style="width:'+G+'px;"><div class="toxic_left toxic_larrow" style="margin-left:-20px;" ><a href="#back"><img src="'+L+'left.png" alt="" /></a></div><div class="toxic_left toxic_rarrow"><a href="#next"><img src="'+L+'right.png" alt="" /></a></div></div><p class="toxic_center countofimages">'+u.im+" "+v+" "+u.o+" "+R+'</p><p class="toxic_center toxic_title" style="margin-bottom:'+A+'px;">'+t+"</p>"),c()),1==f&&s.html('<p class="toxic_center toxic_title" style="width:'+($(this).width()-40)+"px;margin-bottom:"+A+'px;">'+t+"</p>")):((2==f||21==f||22==f)&&(s.html('<p class="toxic_center countofimages" >'+u.im+" "+v+" "+u.o+" "+R+"</p>").prepend('<div id="toxic_arrow_carrier" style="width:'+G+'px;"><div class="toxic_left toxic_larrow" style="margin-left:-20px;" ><a href="#back"><img src="'+L+'left.png" alt="" /></a></div><div class="toxic_left toxic_rarrow"><a href="#next"><img src="'+L+'right.png" alt="" /></a></div></div>'),c()),1==f&&s.css({height:20+A+"px","min-height":0})),o(this),$("#toxic_showbox .toxic_rarrow, #toxic_showbox .toxic_larrow").css("width",""+((G+20)/2-10)+"px"),E=s.height()+E,n.prepend('<a href="#index" class="toxic_links"><img id="toxic_close" class="toxic_hidden toxic_images_close" src="'+L+'close.png" alt="" /></a>'),$("#toxic_close").css({"margin-left":G-20+"px","margin-top":E-20+"px"}),n.velocity({left:z/2-(G/2+A)+$(window).scrollLeft(),top:M/2+$(window).scrollTop()-(E/2+A),width:G,height:E},600/O,function(){a.velocity("fadeOut",150/O),s.css("width",G-40),$("#toxic_showbox .toxic_current, #toxic_showbox #toxic_textarea, #toxic_showbox #toxic_close").velocity("fadeIn",150/O)})})}function a(){var t=$(g).attr("title");$(g).attr("data-toxic-name")&&(C=$('a[data-toxic-name="'+$(g).attr("data-toxic-name")+'"]'),R=C.length),$("body").append('<div id="toxic_dark" class="toxic_images_close"></div><div id="toxic_showbox" style="height:'+j+"px;width:"+S+"px;left:"+(z/2-A-S/2+$(window).scrollLeft())+"px;top:"+(M/2-A-j/2+$(window).scrollTop())+"px;padding:"+A+'px;"></div>'),i(),$(new Image).attr("src",$(g).attr("href")).on("load",n(t))}function s(t,o){g&&(w=$("#"+$(g).attr("data-toxic-databox"))),t&&(w=$("#"+t)),$("body").append('<div id="toxic_dark" class="toxic_div_close"></div><div id="toxic_showbox" style="height:'+j+"px;width:"+S+"px;left:"+(z/2-A-S/2+$(window).scrollLeft())+"px;top:"+(M/2-A-j/2+$(window).scrollTop())+"px;padding:"+A+'px;"></div>');var c=$("#toxic_showbox"),e=parseInt(w.css("paddingBottom")),n=parseInt(w.css("paddingTop")),a=parseInt(w.css("paddingLeft")),s=parseInt(w.css("paddingRight")),r=$(g).attr("title");o&&(r=o),i();var x=$("#toxic_loading");G=w.width()+parseInt(w.css("borderLeftWidth"))+parseInt(w.css("borderRightWidth"))+s+a,G==z&&("on"==T?(G=k,$(w).css("width",G+"px")):G=z-2*A),G>z&&(G=z-parseInt(w.css("borderLeftWidth"))-parseInt(w.css("borderRightWidth"))-s-a-2*A,w.css({width:G+"px",height:"auto"}).find("iframe").attr("width",G)),E=$(w).height()+20+parseInt(w.css("borderTopWidth"))+parseInt(w.css("borderBottomWidth"))+n+e+A,r&&(c.prepend('<h2 id="toxic_h2" style="width:'+G+"px;margin-bottom:"+A+'px;" class="toxic_hidden toxic_center">'+r+"</h2>"),E+=parseInt($("#toxic_h2").css("height"))+parseInt($("#toxic_h2").css("marginTop"))+parseInt($("#toxic_h2").css("marginBottom"))+parseInt($("#toxic_h2").css("paddingTop"))+parseInt($("#toxic_h2").css("paddingBottom"))),c.velocity({width:G,height:E,marginLeft:-(G/2-S/2),marginTop:-M/2+(M-E)/2+j/2},600/O,function(){x.velocity("fadeOut",150/O,function(){$(this).remove()}),c.append(w,'<a href="#index" class="toxic_links"><img id="toxic_close" class="toxic_hidden toxic_div_close" src="'+L+'close.png" alt="" /></a>').css({"min-height":E+"px",height:"auto"}),r?w.css({marginLeft:a+"px",marginTop:n+parseInt($("#toxic_h2").css("marginBottom"))+parseInt($("#toxic_h2").css("paddingBottom"))+"px"}).velocity("fadeIn",150/O):w.css({marginLeft:a+"px",marginTop:n+"px"}).velocity("fadeIn",150/O),$("#toxic_close.toxic_div_close").css({marginLeft:G-20+"px",marginTop:e+A+"px"}).velocity("fadeIn",150/O),$("#toxic_h2").velocity("fadeIn",200/O),parseInt(c.css("top"))+(parseInt(c.css("marginTop"))-$(window).scrollTop())<0&&c.css({marginTop:"0",top:$(window).scrollTop()})})}function r(t){g&&(w=$(g).attr("data-toxic-alert")),t&&(w=t),$("body").append('<div id="toxic_dark" class="toxic_images_close"></div><div id="toxic_showbox" class="alert" style="height:'+j+"px;width:"+S+"px;left:"+(z/2-A-S/2+$(window).scrollLeft())+"px;top:"+(M/2-A-j/2+$(window).scrollTop())+"px;padding:"+A+'px;"></div>');var o=$("#toxic_showbox");o.html('<p class="alert toxic_hidden" style="width:'+B+'px;">'+w+"</p>").prepend('<a href="#index" class="toxic_links"><img id="toxic_close" class="toxic_hidden toxic_images_close" src="'+L+'close.png" alt="" /></a>'),i();var c=$("#toxic_loading"),e=$("#toxic_showbox p");G=e.width(),E=e.height()+20+A,G>=z&&(G=z-2*A,$("#toxic_showbox p.alert").css("max-width",G+"px"),E=e.height()+20+A),o.velocity({width:G,height:E,marginLeft:-(G/2-S/2),marginTop:-M/2+(M-E)/2+j/2},600/O,function(){c.velocity("fadeOut",150/O,function(){$(this).remove()}),e.velocity("fadeIn",150/O),$("#toxic_close.toxic_images_close").css({"margin-left":G-20+"px","margin-top":E-21+"px"}).velocity("fadeIn",150/O)})}function x(t,o){g=t,o=$(g).attr("title"),i(),$(new Image).attr("src",$(g).attr("href")).on("load",function(){$("#toxic_showbox .toxic_current,#toxic_showbox #toxic_textarea, #toxic_showbox #toxic_close, #toxic_showbox #toxic_arrow_carrier").remove(),n(o)})}function d(){S||(S=W-2*A,j=S),$("#toxic_showbox").find(".toxic_div_close").length&&($("body").append(w),w.css({display:"none",margin:0})),$("#toxic_loading").remove(),$("#toxic_dark, #toxic_showbox").remove(),g=void 0,R=$('a[data-toxic="group"]:not([data-toxic-name])').length,C=$('a[data-toxic="group"]:not([data-toxic-name])')}function p(){return S=$("#toxic_showbox").width(),j=$("#toxic_showbox").height(),$("#toxic_dark, #toxic_showbox, #toxic_loading").velocity("fadeOut",150/O,function(){d()}),!1}function h(){$("#toxic_showbox").is(":visible")&&(S=$("#toxic_showbox").width(),j=$("#toxic_showbox").height()),$("#toxic_dark, #toxic_showbox, #toxic_loading").css("display","none"),d()}var l,_,g,w,f,m,u,v,b="en",y={im:"Фото",o:"из"},I={im:"Image",o:"of"},k=960,T="on",L="../images/toxic/",A=5,O=1,B=300,W=150,P={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return P.Android()||P.BlackBerry()||P.iOS()||P.Opera()||P.Windows()}},z=$(window).width(),M=$(window).height(),R=$('a[data-toxic="group"]:not([data-toxic-name])').length,C=$('a[data-toxic="group"]:not([data-toxic-name])'),E=0,G=0;Object.keys(toxicbox_options).length&&(toxicbox_options.language&&(b=toxicbox_options.language),toxicbox_options.padding&&(A=toxicbox_options.padding),toxicbox_options.images_url&&(L=toxicbox_options.images_url),toxicbox_options.alert_width&&(B=toxicbox_options.alert_width),toxicbox_options.basic_width&&(k=toxicbox_options.basic_width),toxicbox_options.auto_width&&(T=toxicbox_options.auto_width),toxicbox_options.speed&&(O=toxicbox_options.speed),toxicbox_options.start_box_size&&(W=toxicbox_options.start_box_size));var S=W-2*A,j=S;return $("a[data-toxic='single'], a[data-toxic='group']").addClass("toxic_zoom"),$(new Image).attr("src",L+"loader.gif"),u="ru"==b?y:I,t(),document.body.addEventListener("touchend",function(i){m=o(),z=screen.width/m,M=window.innerHeight,t()},!1),$(window).resize(function(){if(!P.any()){var t=$("#toxic_showbox");m=o(),z=$(window).width(),M=$(window).height(),t&&(t.css({"margin-left":"0px","margin-top":"0px",left:z/2-(G/2+A)+$(window).scrollLeft()+"px",top:M/2+$(window).scrollTop()-(E/2+A)+"px"}),parseInt(t.css("top"))<0&&t.css("top","0"))}}),$(document).on("click",".toxic_larrow a",function(){return f=21,$("#toxic_loading").remove(),x(l),!1}).on("click",".toxic_rarrow a",function(){return f=22,$("#toxic_loading").remove(),x(_),!1}).on("click",'a[data-toxic="group"]',function(){return f=2,g=this,a(),!1}).on("click",'a[data-toxic="single"]',function(){return f=1,g=this,a(),!1}).on("click","[data-toxic-databox]",function(){return f=3,g=this,s(),!1}).on("click","[data-toxic-alert]",function(){return f=3,g=this,r(),!1}).on("click","#toxic_dark, #toxic_close",function(){return p(),!1}).keyup(function(t){27==t.keyCode&&p()}),{GetDatabox:function(t,o,i){o||(o=0),setTimeout(function(){h(),s(t,i)},o)},GetAlert:function(t,o){o||(o=0),setTimeout(function(){h(),r(t)},o)}}}()});
