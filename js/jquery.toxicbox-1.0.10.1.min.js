//jquery.toxicbox ver.1.0.10.1.min, MIT L, ToxicBox - C 2015-2016 Berestov Andrey, http://my-gallery.name
var toxicbox_options={};$(function(){window.ToxicBox=function(){function t(){(navigator.userAgent.indexOf("Presto")+1||navigator.userAgent.indexOf("iPhone")+1||navigator.userAgent.indexOf("iPad")+1||navigator.userAgent.indexOf("Android")+1)&&(P=window.innerWidth)}function i(){return f=Math.round(window.outerWidth/window.innerWidth*100)/100}function o(){$("body").prepend('<img src="'+T+'loader.gif" alt="" id="toxic_loading" style="margin-top:'+(z/2-20+$(window).scrollTop())+"px;margin-left:"+(P/2-20+$(window).scrollLeft())+'px;"  />')}function e(){$("#toxic_loading").velocity("fadeIn",150/A)}function c(){h||$("#toxic_showbox .toxic_larrow a").remove(),l||$("#toxic_showbox .toxic_rarrow a").remove()}function n(){$(new Image).attr("src",$(h).attr("href")),$(new Image).attr("src",$(l).attr("href"))}function a(t){function i(t){$(t).css({"max-height":z-r.height()-2*L+"px",width:"auto"}),E=$(t).width(),$(t).css("width",E+"px"),C=$(t).height()}var o,e=$("#toxic_showbox"),a=$("#toxic_loading");e.prepend('<img src="'+$(g).attr("href")+'" alt="" class="toxic_current toxic_hidden" style="max-width:'+(P-2*L)+"px;max-height:"+z+'px;" /><div id="toxic_textarea" class="toxic_hidden" style="min-height:'+(41+L)+"px;margin-top:"+L+'px;"></div>');var r=$("#toxic_textarea");if(21==w&&(u-=1,h=R[u-2],l=R[u],n()),22==w&&(u+=1,h=R[u-2],l=R[u],n()),2==w)for(o=0;M>o;o++)if(g==R[o]){u=o+1,h=R[o-1],l=R[o+1],n();break}$(".toxic_current").load(function(){C=$(this).height(),E=$(this).width(),i(this),t?((2==w||21==w||22==w)&&(r.css("width",E-2*L-40+"px").html('<div id="toxic_arrow_carrier" style="width:'+E+'px;"><div class="toxic_left toxic_larrow" style="margin-left:-20px;" ><a href="#back"><img src="'+T+'left.png" alt="" /></a></div><div class="toxic_left toxic_rarrow"><a href="#next"><img src="'+T+'right.png" alt="" /></a></div></div><p class="toxic_center countofimages">'+m.im+" "+u+" "+m.o+" "+M+'</p><p class="toxic_center toxic_title" style="margin-bottom:'+L+'px;">'+t+"</p>"),c()),1==w&&r.html('<p class="toxic_center toxic_title" style="width:'+($(this).width()-40)+"px;padding-top:3px;margin-bottom:"+L+'px;">'+t+"</p>")):((2==w||21==w||22==w)&&(r.html('<p class="toxic_center countofimages" >'+m.im+" "+u+" "+m.o+" "+M+"</p>").prepend('<div id="toxic_arrow_carrier" style="width:'+E+'px;"><div class="toxic_left toxic_larrow" style="margin-left:-20px;" ><a href="#back"><img src="'+T+'left.png" alt="" /></a></div><div class="toxic_left toxic_rarrow"><a href="#next"><img src="'+T+'right.png" alt="" /></a></div></div>'),c()),1==w&&r.css({height:20+L+"px","min-height":0})),i(this),$("#toxic_showbox .toxic_rarrow, #toxic_showbox .toxic_larrow").css("width",""+((E+20)/2-10)+"px"),C=r.height()+C,e.prepend('<a href="#index" class="toxic_links"><img id="toxic_close" class="toxic_hidden toxic_images_close" src="'+T+'close.png" alt="" /></a>'),$("#toxic_close").css({"margin-left":E-20+"px","margin-top":C-20+"px"}),e.velocity({width:E,height:C,marginLeft:-(E/2-G/2),marginTop:-z/2+(z-C)/2+S/2},600/A,function(){a.velocity("fadeOut",150/A),r.css("width",E-40),$("#toxic_showbox .toxic_current, #toxic_showbox #toxic_textarea, #toxic_showbox #toxic_close").velocity("fadeIn",150/A)})})}function r(){var t=$(g).attr("title");$(g).attr("data-toxic-name")&&(R=$('a[data-toxic-name="'+$(g).attr("data-toxic-name")+'"]'),M=R.length),$("body").append('<div id="toxic_dark" class="toxic_images_close"></div><div id="toxic_showbox" style="height:'+S+"px;width:"+G+"px;left:"+(P/2-L-G/2+$(window).scrollLeft())+"px;top:"+(z/2-L-S/2+$(window).scrollTop())+"px;padding:"+L+'px;"></div>'),o(),$(new Image).attr("src",""+$(g).attr("href")).load(a(t))}function s(t,i){g&&(_=$("#"+$(g).attr("data-toxic-databox"))),t&&(_=$("#"+t)),$("body").append('<div id="toxic_dark" class="toxic_div_close"></div><div id="toxic_showbox" style="height:'+S+"px;width:"+G+"px;left:"+(P/2-L-G/2+$(window).scrollLeft())+"px;top:"+(z/2-L-S/2+$(window).scrollTop())+"px;padding:"+L+'px;"></div>');var e=$("#toxic_showbox"),c=parseInt(_.css("paddingBottom")),n=parseInt(_.css("paddingTop")),a=parseInt(_.css("paddingLeft")),r=parseInt(_.css("paddingRight")),s=$(g).attr("title");i&&(s=i),o();var x=$("#toxic_loading");E=_.width()+parseInt(_.css("borderLeftWidth"))+parseInt(_.css("borderRightWidth"))+r+a,E==P&&("on"==k?(E=I,$(_).css("width",E+"px")):E=P-2*L),E>P&&(E=P-parseInt(_.css("borderLeftWidth"))-parseInt(_.css("borderRightWidth"))-r-a-2*L,_.css({width:E+"px",height:"auto"}).find("iframe").attr("width",E)),C=$(_).height()+20+parseInt(_.css("borderTopWidth"))+parseInt(_.css("borderBottomWidth"))+n+c+L,s&&(e.prepend('<h2 id="toxic_h2" style="width:'+E+"px;margin-bottom:"+L+'px;" class="toxic_hidden toxic_center">'+s+"</h2>"),C+=parseInt($("#toxic_h2").css("height"))+parseInt($("#toxic_h2").css("marginTop"))+parseInt($("#toxic_h2").css("marginBottom"))+parseInt($("#toxic_h2").css("paddingTop"))+parseInt($("#toxic_h2").css("paddingBottom"))),e.velocity({width:E,height:C,marginLeft:-(E/2-G/2),marginTop:-z/2+(z-C)/2+S/2},600/A,function(){x.velocity("fadeOut",150/A,function(){$(this).remove()}),e.append(_,'<a href="#index" class="toxic_links"><img id="toxic_close" class="toxic_hidden toxic_div_close" src="'+T+'close.png" alt="" /></a>').css({"min-height":C+"px",height:"auto"}),s?_.css({marginLeft:a+"px",marginTop:n+parseInt($("#toxic_h2").css("marginBottom"))+parseInt($("#toxic_h2").css("paddingBottom"))+"px"}).velocity("fadeIn",150/A):_.css({marginLeft:a+"px",marginTop:n+"px"}).velocity("fadeIn",150/A),$("#toxic_close.toxic_div_close").css({marginLeft:E-20+"px",marginTop:c+L+"px"}).velocity("fadeIn",150/A),$("#toxic_h2").velocity("fadeIn",200/A),parseInt(e.css("top"))+(parseInt(e.css("marginTop"))-$(window).scrollTop())<0&&e.css({marginTop:"0",top:$(window).scrollTop()})})}function x(t){g&&(_=$(g).attr("data-toxic-alert")),t&&(_=t),$("body").append('<div id="toxic_dark" class="toxic_images_close"></div><div id="toxic_showbox" class="alert" style="height:'+S+"px;width:"+G+"px;left:"+(P/2-L-G/2+$(window).scrollLeft())+"px;top:"+(z/2-L-S/2+$(window).scrollTop())+"px;padding:"+L+'px;"></div>');var i=$("#toxic_showbox");i.html('<p class="alert toxic_hidden" style="width:'+O+'px;">'+_+"</p>").prepend('<a href="#index" class="toxic_links"><img id="toxic_close" class="toxic_hidden toxic_images_close" src="'+T+'close.png" alt="" /></a>'),o();var e=$("#toxic_loading"),c=$("#toxic_showbox p");E=c.width(),C=c.height()+20+L,E>=P&&(E=P-2*L,$("#toxic_showbox p.alert").css("max-width",E+"px"),C=c.height()+20+L),i.velocity({width:E,height:C,marginLeft:-(E/2-G/2),marginTop:-z/2+(z-C)/2+S/2},600/A,function(){e.velocity("fadeOut",150/A,function(){$(this).remove()}),c.velocity("fadeIn",150/A),$("#toxic_close.toxic_images_close").css({"margin-left":E-20+"px","margin-top":C-21+"px"}).velocity("fadeIn",150/A)})}function d(t,i){g=t,i=$(g).attr("title"),e(),$(new Image).attr("src",$(g).attr("href")).load(function(){$("#toxic_showbox .toxic_current,#toxic_showbox #toxic_textarea, #toxic_showbox #toxic_close, #toxic_showbox #toxic_arrow_carrier").remove(),a(i)})}function p(){return G=$("#toxic_showbox").width(),S=$("#toxic_showbox").height(),$("#toxic_dark, #toxic_showbox, #toxic_loading").velocity("fadeOut",150/A,function(){$("#toxic_showbox").find(".toxic_div_close").length&&($("body").append(_),_.css({display:"none",margin:0})),3!=w&&$("#toxic_loading").remove(),$("#toxic_dark, #toxic_showbox").remove(),g=void 0,M=$('a[data-toxic="group"]:not([data-toxic-name])').length,R=$('a[data-toxic="group"]:not([data-toxic-name])')}),!1}var h,l,g,_,w,f,m,u,v="en",b={im:"Фото",o:"из"},y={im:"Image",o:"of"},I=960,k="on",T="../images/toxic/",L=5,A=1,O=300,B=150,W={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return W.Android()||W.BlackBerry()||W.iOS()||W.Opera()||W.Windows()}},P=$(window).width(),z=$(window).height(),M=$('a[data-toxic="group"]:not([data-toxic-name])').length,R=$('a[data-toxic="group"]:not([data-toxic-name])'),C=0,E=0;Object.keys(toxicbox_options).length&&(toxicbox_options.language&&(v=toxicbox_options.language),toxicbox_options.padding&&(L=toxicbox_options.padding),toxicbox_options.images_url&&(T=toxicbox_options.images_url),toxicbox_options.alert_width&&(O=toxicbox_options.alert_width),toxicbox_options.basic_width&&(I=toxicbox_options.basic_width),toxicbox_options.auto_width&&(k=toxicbox_options.auto_width),toxicbox_options.speed&&(A=toxicbox_options.speed),toxicbox_options.start_box_size&&(B=toxicbox_options.start_box_size));var G=B-2*L,S=G;return $("a[data-toxic='single'], a[data-toxic='group']").addClass("toxic_zoom"),$(new Image).attr("src",T+"loader.gif"),m="ru"==v?b:y,t(),document.body.addEventListener("touchend",function(o){f=i(),P=screen.width/f,z=window.innerHeight,t()},!1),$(window).resize(function(){if(!W.any()){var t=$("#toxic_showbox");f=i(),P=$(window).width(),z=$(window).height(),t&&(t.css({"margin-left":"0px","margin-top":"0px",left:P/2-(E/2+L)+$(window).scrollLeft()+"px",top:z/2+$(window).scrollTop()-(C/2+L)+"px"}),parseInt(t.css("top"))<0&&t.css("top","0"))}}),$(document).on("click",".toxic_larrow a",function(){return w=21,d(h),!1}).on("click",".toxic_rarrow a",function(){return w=22,d(l),!1}).on("click",'a[data-toxic="group"]',function(){return w=2,g=this,r(),!1}).on("click",'a[data-toxic="single"]',function(){return w=1,g=this,r(),!1}).on("click","[data-toxic-databox]",function(){return w=3,g=this,s(),!1}).on("click","[data-toxic-alert]",function(){return w=3,g=this,x(),!1}).on("click","#toxic_dark, #toxic_close",function(){return p(),!1}).keyup(function(t){27==t.keyCode&&p()}),{GetDatabox:function(t,i,o){i||(i=0),setTimeout(function(){s(t,o)},i)},GetAlert:function(t,i){i||(i=0),setTimeout(function(){x(t,i)},i)}}}()});
