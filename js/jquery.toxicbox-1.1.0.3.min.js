//jquery.toxicbox ver.1.1.0.3.min, MIT L, ToxicBox - C 2015-2016 Berestov Andrey, http://my-gallery.name
var toxicbox_options={};$(function(){window.ToxicBox=function(){function t(){(navigator.userAgent.indexOf("Presto")+1||navigator.userAgent.indexOf("iPhone")+1||navigator.userAgent.indexOf("iPad")+1||navigator.userAgent.indexOf("Android")+1)&&(j=window.innerWidth)}function o(){return m=Math.round(window.outerWidth/window.innerWidth*100)/100}function i(){$("body").prepend('<img src="'+L+'loader.gif" alt="" id="toxicbox_loading" style="top:0;margin-top:'+(z/2-20+$(window).scrollTop())+"px;margin-left:"+(j/2-20+$(window).scrollLeft())+'px;"  />')}function e(){l||$("#toxicbox .toxicbox_left_arrow a").remove(),b||$("#toxicbox .toxicbox_right_arrow a").remove()}function a(){$(new Image).attr("src",$(l).attr("href")),$(new Image).attr("src",$(b).attr("href"))}function c(t){function o(t){$(t).css({"max-height":z-n.height()-2*A+"px",width:"auto"}),E=$(t).width(),$(t).css("width",E+"px"),C=$(t).height()}var i,c=$("#toxicbox"),x=$("#toxicbox_loading");c.prepend('<img src="'+$(h).attr("href")+'" alt="" class="toxicbox_the_current_object toxicbox_hidden" style="max-width:'+(j-2*A)+"px;max-height:"+z+'px;" /><div id="toxicbox_text_frame" class="toxicbox_hidden" style="min-height:'+(41+A)+"px;margin-top:"+A+'px;"></div>');var n=$("#toxicbox_text_frame");if(21==f&&(w-=1,l=R[w-2],b=R[w],a()),22==f&&(w+=1,l=R[w-2],b=R[w],a()),2==f)for(i=0;M>i;i++)if(h==R[i]){w=i+1,l=R[i-1],b=R[i+1],a();break}$(".toxicbox_the_current_object").on("load",function(){C=$(this).height(),E=$(this).width(),o(this),t?((2==f||21==f||22==f)&&(n.css("width",E-2*A-40+"px").html('<div id="toxicbox_arrow_frame" style="width:'+E+'px;"><div class="toxicbox_left toxicbox_left_arrow" style="margin-left:-20px;" ><a href="#back"><img src="'+L+'left.png" alt="" /></a></div><div class="toxicbox_left toxicbox_right_arrow"><a href="#next"><img src="'+L+'right.png" alt="" /></a></div></div><p class="toxicbox_center toxicbox_pictures_count">'+u.im+" "+w+" "+u.o+" "+M+'</p><p class="toxicbox_center toxicbox_name_of_picture" style="margin-bottom:'+A+'px;">'+t+"</p>"),e()),1==f&&n.html('<p class="toxicbox_center toxicbox_name_of_picture" style="width:'+($(this).width()-40)+"px;margin-bottom:"+A+'px;">'+t+"</p>")):((2==f||21==f||22==f)&&(n.html('<p class="toxicbox_center toxicbox_pictures_count" >'+u.im+" "+w+" "+u.o+" "+M+"</p>").prepend('<div id="toxicbox_arrow_frame" style="width:'+E+'px;"><div class="toxicbox_left toxicbox_left_arrow" style="margin-left:-20px;" ><a href="#back"><img src="'+L+'left.png" alt="" /></a></div><div class="toxicbox_left toxicbox_right_arrow"><a href="#next"><img src="'+L+'right.png" alt="" /></a></div></div>'),e()),1==f&&n.css({height:20+A+"px","min-height":0})),o(this),$("#toxicbox .toxicbox_right_arrow, #toxicbox .toxicbox_left_arrow").css("width",""+((E+20)/2-10)+"px"),C=n.height()+C,c.prepend('<a href="#index" class="toxicbox_parent_of_close_button"><img id="toxicbox_close_image" class="toxicbox_hidden toxic_images_close" src="'+L+'close.png" alt="" /></a>'),$("#toxicbox_close_image").css({"margin-left":E-20+"px","margin-top":C-20+"px"}),c.velocity({left:j/2-(E/2+A)+$(window).scrollLeft(),top:z/2+$(window).scrollTop()-(C/2+A),width:E,height:C},600/O,function(){x.velocity("fadeOut",150/O),n.css("width",E-40),$("#toxicbox .toxicbox_the_current_object, #toxicbox #toxicbox_text_frame, #toxicbox #toxicbox_close_image").velocity("fadeIn",150/O)})})}function x(){var t=$(h).attr("title");$(h).attr("data-toxic-name")&&(R=$('a[data-toxic-name="'+$(h).attr("data-toxic-name")+'"]'),M=R.length),$("body").append('<div id="toxicbox_darkness_substrate" class="toxic_images_close"></div><div id="toxicbox" style="height:'+S+"px;width:"+G+"px;left:"+(j/2-A-G/2+$(window).scrollLeft())+"px;top:"+(z/2-A-S/2+$(window).scrollTop())+"px;padding:"+A+'px;"></div>'),i(),$(new Image).attr("src",$(h).attr("href")).on("load",c(t))}function n(t,o){h&&(g=$("#"+$(h).attr("data-toxic-databox"))),t&&(g=$("#"+t)),$("body").append('<div id="toxicbox_darkness_substrate" class="toxicbox_databox_prefix"></div><div id="toxicbox" style="height:'+S+"px;width:"+G+"px;left:"+(j/2-A-G/2+$(window).scrollLeft())+"px;top:"+(z/2-A-S/2+$(window).scrollTop())+"px;padding:"+A+'px;"></div>');var e=$("#toxicbox"),a=parseInt(g.css("paddingBottom")),c=parseInt(g.css("paddingTop")),x=parseInt(g.css("paddingLeft")),n=parseInt(g.css("paddingRight")),r=$(h).attr("title");o&&(r=o),i();var s=$("#toxicbox_loading");E=g.width()+parseInt(g.css("borderLeftWidth"))+parseInt(g.css("borderRightWidth"))+n+x,E==j&&("on"==T?(E=k,$(g).css("width",E+"px")):E=j-2*A),E>j&&(E=j-parseInt(g.css("borderLeftWidth"))-parseInt(g.css("borderRightWidth"))-n-x-2*A,g.css({width:E+"px",height:"auto"}).find("iframe").attr("width",E)),C=$(g).height()+20+parseInt(g.css("borderTopWidth"))+parseInt(g.css("borderBottomWidth"))+c+a+A,r&&(e.prepend('<h2 id="toxicbox_header" style="width:'+E+"px;margin-bottom:"+A+'px;" class="toxicbox_hidden toxicbox_center">'+r+"</h2>"),C+=parseInt($("#toxicbox_header").css("height"))+parseInt($("#toxicbox_header").css("marginTop"))+parseInt($("#toxicbox_header").css("marginBottom"))+parseInt($("#toxicbox_header").css("paddingTop"))+parseInt($("#toxicbox_header").css("paddingBottom"))),e.velocity({width:E,height:C,marginLeft:-(E/2-G/2),marginTop:-z/2+(z-C)/2+S/2},600/O,function(){s.velocity("fadeOut",150/O,function(){$(this).remove()}),e.append(g,'<a href="#index" class="toxicbox_parent_of_close_button"><img id="toxicbox_close_image" class="toxicbox_hidden toxicbox_databox_prefix" src="'+L+'close.png" alt="" /></a>').css({"min-height":C+"px",height:"auto"}),r?g.css({marginLeft:x+"px",marginTop:c+parseInt($("#toxicbox_header").css("marginBottom"))+parseInt($("#toxicbox_header").css("paddingBottom"))+"px"}).velocity("fadeIn",150/O):g.css({marginLeft:x+"px",marginTop:c+"px"}).velocity("fadeIn",150/O),$("#toxicbox_close_image.toxicbox_databox_prefix").css({marginLeft:E-20+"px",marginTop:a+A+"px"}).velocity("fadeIn",150/O),$("#toxicbox_header").velocity("fadeIn",200/O),parseInt(e.css("top"))+(parseInt(e.css("marginTop"))-$(window).scrollTop())<0&&e.css({marginTop:"0",top:$(window).scrollTop()})})}function r(t){h&&(g=$(h).attr("data-toxic-alert")),t&&(g=t),$("body").append('<div id="toxicbox_darkness_substrate" class="toxic_images_close"></div><div id="toxicbox" class="toxicbox_alert_frame" style="height:'+S+"px;width:"+G+"px;left:"+(j/2-A-G/2+$(window).scrollLeft())+"px;top:"+(z/2-A-S/2+$(window).scrollTop())+"px;padding:"+A+'px;"></div>');var o=$("#toxicbox");o.html('<p class="toxicbox_alert_frame toxicbox_hidden" style="width:'+B+'px;">'+g+"</p>").prepend('<a href="#index" class="toxicbox_parent_of_close_button"><img id="toxicbox_close_image" class="toxicbox_hidden toxic_images_close" src="'+L+'close.png" alt="" /></a>'),i();var e=$("#toxicbox_loading"),a=$("#toxicbox p");E=a.width(),C=a.height()+20+A,E>=j&&(E=j-2*A,$("#toxicbox .toxicbox_alert_frame").css("max-width",E+"px"),C=a.height()+20+A),o.velocity({width:E,height:C,marginLeft:-(E/2-G/2),marginTop:-z/2+(z-C)/2+S/2},600/O,function(){e.velocity("fadeOut",150/O,function(){$(this).remove()}),a.velocity("fadeIn",150/O),$("#toxicbox_close_image.toxic_images_close").css({"margin-left":E-20+"px","margin-top":C-21+"px"}).velocity("fadeIn",150/O)})}function s(t,o){h=t,o=$(h).attr("title"),i(),$(new Image).attr("src",$(h).attr("href")).on("load",function(){$("#toxicbox .toxicbox_the_current_object,#toxicbox #toxicbox_text_frame, #toxicbox #toxicbox_close_image, #toxicbox #toxicbox_arrow_frame").remove(),c(o)})}function d(){G||(G=W-2*A,S=G),$("#toxicbox").find(".toxicbox_databox_prefix").length&&($("body").append(g),g.css({display:"none",margin:0})),$("#toxicbox_loading").remove(),$("#toxicbox_darkness_substrate, #toxicbox").remove(),h=void 0,M=$('a[data-toxic="group"]:not([data-toxic-name])').length,R=$('a[data-toxic="group"]:not([data-toxic-name])')}function p(){return G=$("#toxicbox").width(),S=$("#toxicbox").height(),$("#toxicbox_darkness_substrate, #toxicbox, #toxicbox_loading").velocity("fadeOut",150/O,function(){d()}),!1}function _(){$("#toxicbox").is(":visible")&&(G=$("#toxicbox").width(),S=$("#toxicbox").height()),$("#toxicbox_darkness_substrate, #toxicbox, #toxicbox_loading").css("display","none"),d()}var l,b,h,g,f,m,u,w,v="en",y={im:"Фото",o:"из"},I={im:"Image",o:"of"},k=960,T="on",L="../images/toxic/",A=5,O=1,B=300,W=150,P={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return P.Android()||P.BlackBerry()||P.iOS()||P.Opera()||P.Windows()}},j=$(window).width(),z=$(window).height(),M=$('a[data-toxic="group"]:not([data-toxic-name])').length,R=$('a[data-toxic="group"]:not([data-toxic-name])'),C=0,E=0;Object.keys(toxicbox_options).length&&(toxicbox_options.language&&(v=toxicbox_options.language),toxicbox_options.padding&&(A=toxicbox_options.padding),toxicbox_options.images_url&&(L=toxicbox_options.images_url),toxicbox_options.alert_width&&(B=toxicbox_options.alert_width),toxicbox_options.basic_width&&(k=toxicbox_options.basic_width),toxicbox_options.auto_width&&(T=toxicbox_options.auto_width),toxicbox_options.speed&&(O=toxicbox_options.speed),toxicbox_options.start_box_size&&(W=toxicbox_options.start_box_size));var G=W-2*A,S=G;return $("a[data-toxic='single'], a[data-toxic='group']").addClass("toxicbox_zoom_style"),$(new Image).attr("src",L+"loader.gif"),u="ru"==v?y:I,t(),document.body.addEventListener("touchend",function(i){m=o(),j=screen.width/m,z=window.innerHeight,t()},!1),$(window).resize(function(){if(!P.any()){var t=$("#toxicbox");m=o(),j=$(window).width(),z=$(window).height(),t&&(t.css({"margin-left":"0px","margin-top":"0px",left:j/2-(E/2+A)+$(window).scrollLeft()+"px",top:z/2+$(window).scrollTop()-(C/2+A)+"px"}),parseInt(t.css("top"))<0&&t.css("top","0"))}}),$(document).on("click",".toxicbox_left_arrow a",function(){return f=21,$("#toxicbox_loading").remove(),s(l),!1}).on("click",".toxicbox_right_arrow a",function(){return f=22,$("#toxicbox_loading").remove(),s(b),!1}).on("click",'a[data-toxic="group"]',function(){return f=2,h=this,x(),!1}).on("click",'a[data-toxic="single"]',function(){return f=1,h=this,x(),!1}).on("click","[data-toxic-databox]",function(){return f=3,h=this,n(),!1}).on("click","[data-toxic-alert]",function(){return f=3,h=this,r(),!1}).on("click","#toxicbox_darkness_substrate, #toxicbox_close_image",function(){return p(),!1}).keyup(function(t){27==t.keyCode&&p()}),{GetDatabox:function(t,o,i){o||(o=0),setTimeout(function(){_(),n(t,i)},o)},GetAlert:function(t,o){o||(o=0),setTimeout(function(){_(),r(t)},o)}}}()});
