//jquery.toxicbox ver.1.0.7.min, MIT L, ToxicBox - C 2015-2016 Berestov Andrey, http://my-gallery.name
var toxicbox_options={};$(function(){window.ToxicBox=function(){function t(){(navigator.userAgent.indexOf("Presto")+1||navigator.userAgent.indexOf("iPhone")+1||navigator.userAgent.indexOf("iPad")+1||navigator.userAgent.indexOf("Android")+1)&&(B=window.innerWidth)}function i(){return w=Math.round(window.outerWidth/window.innerWidth*100)/100}function o(){$("body").prepend('<img src="'+I+'loader.gif" alt="" id="toxic_loading" style="margin-top:'+(W/2-20+$(window).scrollTop())+"px;margin-left:"+(B/2-20+$(window).scrollLeft())+'px;"  />')}function e(){$("#toxic_loading").velocity("fadeIn",150/T)}function n(){p||$("#toxic_showbox .toxic_larrow a").remove(),h||$("#toxic_showbox .toxic_rarrow a").remove()}function c(t){function i(t){$(t).css({"max-height":W-r.height()-2*k+"px",width:"auto"}),R=$(t).width(),$(t).css("width",R+"px"),M=$(t).height()}var o,e,c=$("#toxic_showbox"),a=$("#toxic_loading");c.prepend('<img src="'+$(l).attr("href")+'" alt="" class="toxic_current toxic_hidden" style="max-width:'+(B-2*k)+"px;max-height:"+W+'px;" /><div id="toxic_textarea" class="toxic_hidden" style="min-height:'+(41+k)+"px;margin-top:"+k+'px;"></div>');var r=$("#toxic_textarea");for(e=0;P>e;e++)if(l==z[e]){o=e+1,p=z[e-1],h=z[e+1],$(new Image).attr("src",$(p).attr("href")),$(new Image).attr("src",$(h).attr("href"));break}$(".toxic_current").load(function(){M=$(this).height(),R=$(this).width(),i(this),t?(2==_&&(r.css("width",R-2*k-40+"px").html('<div id="toxic_arrow_carrier" style="width:'+R+'px;"><div class="toxic_left toxic_larrow" style="margin-left:-20px;" ><a href="#back"><img src="'+I+'left.png" alt="" /></a></div><div class="toxic_left toxic_rarrow"><a href="#next"><img src="'+I+'right.png" alt="" /></a></div></div><p class="toxic_center countofimages">'+f.im+" "+o+" "+f.o+" "+P+'</p><p class="toxic_center toxic_title" style="margin-bottom:'+k+'px;">'+t+"</p>"),n()),1==_&&r.html('<p class="toxic_center toxic_title" style="width:'+($(this).width()-40)+"px;padding-top:4px;margin-bottom:"+k+'px;">'+t+"</p>")):(2==_&&(r.html('<p class="toxic_center countofimages" >'+f.im+" "+o+" "+f.o+" "+P+"</p>").prepend('<div id="toxic_arrow_carrier" style="width:'+R+'px;"><div class="toxic_left toxic_larrow" style="margin-left:-20px;" ><a href="#back"><img src="'+I+'left.png" alt="" /></a></div><div class="toxic_left toxic_rarrow"><a href="#next"><img src="'+I+'right.png" alt="" /></a></div></div>'),n()),1==_&&r.css({height:20+k+"px","min-height":0})),i(this),$("#toxic_showbox .toxic_rarrow, #toxic_showbox .toxic_larrow").css("width",""+((R+20)/2-10)+"px"),M=r.height()+M,c.prepend('<a href="#index"><img id="toxic_close" class="toxic_hidden images_close" src="'+I+'close.png" alt="" /></a>'),$("#toxic_close").css({"margin-left":R-20+"px","margin-top":M-20+"px"}),c.velocity({width:R,height:M,marginLeft:-(R/2-C/2),marginTop:-W/2+(W-M)/2+E/2},600/T,function(){a.velocity("fadeOut",150/T),r.css("width",R-40),$("#toxic_showbox .toxic_current, #toxic_showbox #toxic_textarea, #toxic_showbox #toxic_close").velocity("fadeIn",150/T)})})}function a(){var t=$(l).attr("title");$("body").append('<div id="toxic_dark" class="images_close"></div><div id="toxic_showbox" style="height:'+E+"px;width:"+C+"px;left:"+(B/2-k-C/2+$(window).scrollLeft())+"px;top:"+(W/2-k-E/2+$(window).scrollTop())+"px;padding:"+k+'px;"></div>'),o(),$(new Image).attr("src",""+$(l).attr("href")).load(c(t))}function r(t,i){l&&(g=$("#"+$(l).attr("data-toxic-databox"))),t&&(g=$("#"+t)),$("body").append('<div id="toxic_dark" class="div_close"></div><div id="toxic_showbox" style="height:'+E+"px;width:"+C+"px;left:"+(B/2-k-C/2+$(window).scrollLeft())+"px;top:"+(W/2-k-E/2+$(window).scrollTop())+"px;padding:"+k+'px;"></div>');var e=$("#toxic_showbox"),n=parseInt(g.css("paddingBottom")),c=parseInt(g.css("paddingTop")),a=parseInt(g.css("paddingLeft")),r=parseInt(g.css("paddingRight")),s=$(l).attr("title");i&&(s=i),o();var d=$("#toxic_loading");R=g.width()+parseInt(g.css("borderLeftWidth"))+parseInt(g.css("borderRightWidth"))+r+a,R==B&&("on"==y?(R=b,$(g).css("width",R+"px")):R=B-2*k),R>B&&(R=B-parseInt(g.css("borderLeftWidth"))-parseInt(g.css("borderRightWidth"))-r-a-2*k,g.css({width:R+"px",height:"auto"}).find("iframe").attr("width",R)),M=$(g).height()+20+parseInt(g.css("borderTopWidth"))+parseInt(g.css("borderBottomWidth"))+c+n+k,s&&(e.prepend('<h2 id="toxic_h2" style="width:'+R+"px;margin-bottom:"+k+'px;" class="toxic_hidden">'+s+"</h2>"),M+=parseInt($("#toxic_h2").css("height"))+parseInt($("#toxic_h2").css("marginTop"))+parseInt($("#toxic_h2").css("marginBottom"))+parseInt($("#toxic_h2").css("paddingTop"))+parseInt($("#toxic_h2").css("paddingBottom"))),e.velocity({width:R,height:M,marginLeft:-(R/2-C/2),marginTop:-W/2+(W-M)/2+E/2},600/T,function(){d.velocity("fadeOut",150/T,function(){$(this).remove()}),e.append(g,'<a href="#index"><img id="toxic_close" class="toxic_hidden div_close" src="'+I+'close.png" alt="" /></a>').css({"min-height":M+"px",height:"auto"}),s?g.css({marginLeft:a+"px",marginTop:c+parseInt($("#toxic_h2").css("marginBottom"))+parseInt($("#toxic_h2").css("paddingBottom"))+"px"}).velocity("fadeIn",150/T):g.css({marginLeft:a+"px",marginTop:c+"px"}).velocity("fadeIn",150/T),$("#toxic_close.div_close").css({marginLeft:R-20+"px",marginTop:n+k+"px"}).velocity("fadeIn",150/T),$("#toxic_h2").velocity("fadeIn",200/T),parseInt(e.css("top"))+(parseInt(e.css("marginTop"))-$(window).scrollTop())<0&&e.css({marginTop:"0",top:$(window).scrollTop()})})}function s(t){l&&(g=$(l).attr("data-toxic-alert")),t&&(g=t),$("body").append('<div id="toxic_dark" class="images_close"></div><div id="toxic_showbox" class="alert" style="height:'+E+"px;width:"+C+"px;left:"+(B/2-k-C/2+$(window).scrollLeft())+"px;top:"+(W/2-k-E/2+$(window).scrollTop())+"px;padding:"+k+'px;"></div>');var i=$("#toxic_showbox");i.html('<p class="alert toxic_hidden" style="width:'+L+'px;">'+g+"</p>").prepend('<a href="#index"><img id="toxic_close" class="toxic_hidden images_close" src="'+I+'close.png" alt="" /></a>'),o();var e=$("#toxic_loading"),n=$("#toxic_showbox p");R=n.width(),M=n.height()+20+k,R>=B&&(R=B-2*k,$("#toxic_showbox p.alert").css("max-width",R+"px"),M=n.height()+20+k),i.velocity({width:R,height:M,marginLeft:-(R/2-C/2),marginTop:-W/2+(W-M)/2+E/2},600/T,function(){e.velocity("fadeOut",150/T,function(){$(this).remove()}),n.velocity("fadeIn",150/T),$("#toxic_close.images_close").css({"margin-left":R-20+"px","margin-top":M-21+"px"}).velocity("fadeIn",150/T)})}function d(t,i){l=t,i=$(l).attr("title"),e(),$(new Image).attr("src",$(l).attr("href")).load(function(){$("#toxic_showbox .toxic_current,#toxic_showbox #toxic_textarea, #toxic_showbox #toxic_close, #toxic_showbox #toxic_arrow_carrier").remove(),c(i)})}function x(){return C=$("#toxic_showbox").width(),E=$("#toxic_showbox").height(),$("#toxic_dark, #toxic_showbox, #toxic_loading").velocity("fadeOut",150/T,function(){$("#toxic_showbox").find(".div_close").length&&($("body").append(g),g.css({display:"none",margin:0})),3!=_&&$("#toxic_loading").remove(),$("#toxic_dark, #toxic_showbox").remove()}),!1}var p,h,l,g,_,w,f,m="en",u={im:"Фото",o:"из"},v={im:"Image",o:"of"},b=960,y="on",I="../images/toxic/",k=5,T=1,L=300,A=150,O={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return O.Android()||O.BlackBerry()||O.iOS()||O.Opera()||O.Windows()}},B=$(window).width(),W=$(window).height(),P=$('a[data-toxic="group"]').length,z=$('a[data-toxic="group"]'),M=0,R=0;Object.keys(toxicbox_options).length&&(toxicbox_options.language&&(m=toxicbox_options.language),toxicbox_options.padding&&(k=toxicbox_options.padding),toxicbox_options.images_url&&(I=toxicbox_options.images_url),toxicbox_options.alert_width&&(L=toxicbox_options.alert_width),toxicbox_options.basic_width&&(b=toxicbox_options.basic_width),toxicbox_options.auto_width&&(y=toxicbox_options.auto_width),toxicbox_options.speed&&(T=toxicbox_options.speed),toxicbox_options.start_box_size&&(A=toxicbox_options.start_box_size));var C=A-2*k,E=C;return $("a[data-toxic='single'], a[data-toxic='group']").addClass("toxic_zoom"),$(new Image).attr("src",I+"loader.gif"),f="ru"==m?u:v,t(),document.body.addEventListener("touchend",function(o){w=i(),B=screen.width/w,W=window.innerHeight,t()},!1),$(window).resize(function(){if(!O.any()){var t=$("#toxic_showbox");w=i(),B=$(window).width(),W=$(window).height(),t&&(t.css({"margin-left":"0px","margin-top":"0px",left:B/2-(R/2+k)+$(window).scrollLeft()+"px",top:W/2+$(window).scrollTop()-(M/2+k)+"px"}),parseInt(t.css("top"))<0&&t.css("top","0"))}}),$(document).on("click",".toxic_larrow a",function(){return d(p),!1}).on("click",".toxic_rarrow a",function(){return d(h),!1}).on("click",'a[data-toxic="group"]',function(){return _=2,l=this,a(),!1}).on("click",'a[data-toxic="single"]',function(){return _=1,l=this,a(),!1}).on("click","[data-toxic-databox]",function(){return _=3,l=this,r(),!1}).on("click","[data-toxic-alert]",function(){return _=3,l=this,s(),!1}).on("click","#toxic_dark, #toxic_close",function(){return x(),!1}).keyup(function(t){27==t.keyCode&&x()}),{GetDatabox:function(t,i,o){i||(i=0),setTimeout(function(){r(t,o)},i)},GetAlert:function(t,i){i||(i=0),setTimeout(function(){s(t,i)},i)}}}()});
